<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="styles.css" rel="stylesheet" type="text/css">
    <title>Secure Encryption</title>
</head>
<body>
    <div>
        <input type="text" id="original" placeholder="Original text">
        <input type="number" id="encrypt_offset" placeholder="Encryption offset">
        <button id="encrypt_button">Encrypt</button>
        <input type="text" id="encrypted" placeholder="Encrypted text" readonly>
    </div>
    <div>
        <h1>Decrypt Text</h1>
        <input type="text" id="encrypted_text" placeholder="Encrypted text">
        <input type="number" id="decrypt_offset" placeholder="Decryption offset">
        <button id="decrypt_button">Decrypt</button>
        <input type="text" id="decrypted" placeholder="Decrypted text" readonly>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            async function encrypt() {
                try {
                    const original = document.getElementById("original").value.trim();
                    const offset = parseInt(document.getElementById("encrypt_offset").value, 10);

                    if (!original || isNaN(offset) || offset < 0 || offset > 999) {
                        alert("Invalid input. Please ensure text is provided and offset is between 0 and 999.");
                        return;
                    }

                    const encrypted = btoa(unescape(encodeURIComponent(original))) + offset;
                    document.getElementById("encrypted").value = encrypted;
                } catch (error) {
                    console.error("Encryption error:", error);
                    alert("Encryption failed.");
                }
            }

            async function decrypt() {
                try {
                    const encrypted = document.getElementById("encrypted_text").value.trim();
                    const offset = parseInt(document.getElementById("decrypt_offset").value, 10);

                    if (!encrypted || isNaN(offset) || offset < 0 || offset > 999) {
                        alert("Invalid input. Please ensure text is provided and offset is between 0 and 999.");
                        return;
                    }

                    const base64Text = encrypted.slice(0, -offset.toString().length);
                    const decrypted = decodeURIComponent(escape(atob(base64Text)));
                    document.getElementById("decrypted").value = decrypted;
                } catch (error) {
                    console.error("Decryption error:", error);
                    alert("Decryption failed.");
                }
            }

            document.getElementById("encrypt_button").addEventListener("click", encrypt);
            document.getElementById("decrypt_button").addEventListener("click", decrypt);
        });
    </script>
</body>
</html>
